---
tags: ["python", "running", "strava", "API", "analysis", "regression", "polylines"]
description: "Further analysis of my longest run yet"
---
# Pace Check II

#### Further analysis of my longest run yet

Hopefully you have already checked out my first project, [Pace Check](http://jwalk.io/projects/pace_check), 
where I briefly analyzed of one of my runs tracked with the [Strava App](https://www.strava.com/). This time, we are going to analyze my longest run: a half marathon across the Golden Gate Bridge! 



Completing this run was a long term goal of mine, and a significant personal challenge to overcome. About three and a half years ago I shattered two bones in my left leg necessitating two surgeries. As a result, it is very difficult and painful to train. But that's enough complaining- let's get started!

Instead of downloading my running data like last time, I decided to connect to Strava using the [developer API](http://developers.strava.com/docs/reference/) instead. 
For this project I used the ready-to-go Python client, [stravaio](https://pypi.org/project/stravaio/). 
Once I created a Strava API application I passed my credentials to the client, which returns my access token (this is secret so I won't be sharing it here).
Now I can use the client to access my Strava account information, like recent runs.


```python
access_token = '04515d0d07bf7f52475e85bcddb36d8443f331da'

from stravaio import StravaIO
client = StravaIO(access_token=access_token)

recent_runs_list = client.get_logged_in_athlete_activities(after='last month')
```

    Fetched 6, the latests is on 2020-06-11 01:48:10+00:00



```python
# take a look at one of the runs
recent_runs_list[0]
```




    {'achievement_count': 11,
     'athlete': {'id': 53889752},
     'athlete_count': 1,
     'average_speed': 3.022,
     'average_watts': None,
     'comment_count': 0,
     'commute': False,
     'device_watts': None,
     'distance': 10511.1,
     'elapsed_time': 3492,
     'elev_high': 27.0,
     'elev_low': 2.8,
     'end_latlng': [37.81, -122.41],
     'external_id': '8FBE8D55-6D19-4BF3-B487-1FDCBC80C30F',
     'flagged': False,
     'gear_id': None,
     'has_kudoed': False,
     'id': 3482935194,
     'kilojoules': None,
     'kudos_count': 0,
     'manual': False,
     'map': {'id': 'a3482935194',
             'polyline': None,
             'summary_polyline': 'waweF~tbjVGc@OKa@Cw@DKDIFELER@NAPGLWPIAk@Fi@r@INId@Q^IT[rBEd@?RG^?v@In@@f@ETGr@BbAI`@Cz@I`@I|@BL?RMz@BpAMJF\\?VHv@TvCBZEr@Bl@Nt@ATTfBNn@L~AJ|CR~@Fx@NbAAPBv@Hr@NzCJdADrADn@BtBDp@PvAd@hB`@dAd@z@HVx@`BHf@?lBKfAo@pC[bAAr@CHIHWLYRm@V_@HcANw@By@LyACeBM}@Yc@W_A}@[e@O]O{@G}AFk@La@D]G@Oz@?x@H~@DT^z@bAxALLr@f@t@^v@PZDpAA~AMT@Fr@@nAC^[xBC`A{@jB@n@Od@NIrAsBRUH@PJ\\n@^^LPNHh@l@LFv@Lh@AJBZVd@f@FN\\t@b@t@NN\\Zt@\\d@^HDj@JHABRA\\Q|@KJKDORg@vAOv@Gb@Ax@NzBIRS\\KB[Dc@RQDgARu@FULEVLp@Bb@HbAOpAMN_@FQLa@JKFGFKn@HdAHb@RdDJh@@fCBPHtBZlDDbADTDhARjBFrAFv@FVHNLHz@JL?TEFBBHT~CJz@LnC`@vEBhANvAFxAAh@HbBARWFWAWB_A\\WT_@t@g@t@EJ?RFdA?j@DZ^vAh@d@HLBPJvAT|FR~AFn@ANEJEBSOKQSqA[gGEqBIkAEa@i@qBQmA@OB_@HOj@u@`@a@d@m@JKZGXMv@EFI?IQaBk@uLWgCYaEImBMmAKoCK}AG}AGw@EsAYkDWqBa@cF?iAKmACMt@kBj@u@j@eAn@y@fBcDJ[Da@?aAOqBQsA?m@BI`B}@DOV@HVVVd@ZXOTYVOPG~@IFEBIi@mE@QCYMw@QoBC{@Bi@AkAB[Ke@C}@Ks@CgAg@}F?{@ESC{@C[GUKUGE]DWAq@@e@Hm@Rg@Fw@@k@\\_AXM@KIAMK_@Ag@F]Zm@J[Js@[wDSe@Om@m@}AQWu@q@QS]u@Io@GMCQG{@WcAKq@Bk@Ao@Ey@Km@EwBQgBE}BEa@YaAYeDE_AKe@EsASyBE{AGi@EaBMuAIiB?qAVoDVcBHKHAp@Bb@Cj@Yb@MNYZQ'},
     'max_speed': 13.3,
     'max_watts': None,
     'moving_time': 3478,
     'name': 'Afternoon Run',
     'photo_count': 0,
     'private': False,
     'start_date': datetime.datetime(2020, 5, 19, 23, 41, 31, tzinfo=tzutc()),
     'start_date_local': datetime.datetime(2020, 5, 19, 16, 41, 31, tzinfo=tzutc()),
     'start_latlng': [37.81, -122.41],
     'timezone': '(GMT-08:00) America/Los_Angeles',
     'total_elevation_gain': 52.3,
     'total_photo_count': 0,
     'trainer': False,
     'type': 'Run',
     'upload_id': 3719530643,
     'weighted_average_watts': None,
     'workout_type': 0}




```python
#each run has a customized object
type(recent_runs_list[0])
```




    swagger_client.models.summary_activity.SummaryActivity




```python
# we want to make each run a dictionary to make it easier to navigate
recent_runs = [run.to_dict() for run in recent_runs_list]
```

Ok, so in the past month I have completed a handful of runs- but which is the one we want to analyze? Lets throw these in a dataframe so it is easy to view and see which run was the longest. 


```python
import pandas as pd
pd.options.display.max_columns = 50 #show more columns so we can see all of them

#have pandas parse each nested dictionary it into a flat dataframe
recent_runs = pd.json_normalize(recent_runs)
recent_runs
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>external_id</th>
      <th>upload_id</th>
      <th>name</th>
      <th>distance</th>
      <th>moving_time</th>
      <th>elapsed_time</th>
      <th>total_elevation_gain</th>
      <th>elev_high</th>
      <th>elev_low</th>
      <th>type</th>
      <th>start_date</th>
      <th>start_date_local</th>
      <th>timezone</th>
      <th>start_latlng</th>
      <th>end_latlng</th>
      <th>achievement_count</th>
      <th>kudos_count</th>
      <th>comment_count</th>
      <th>athlete_count</th>
      <th>photo_count</th>
      <th>total_photo_count</th>
      <th>trainer</th>
      <th>commute</th>
      <th>manual</th>
      <th>private</th>
      <th>flagged</th>
      <th>workout_type</th>
      <th>average_speed</th>
      <th>max_speed</th>
      <th>has_kudoed</th>
      <th>gear_id</th>
      <th>kilojoules</th>
      <th>average_watts</th>
      <th>device_watts</th>
      <th>max_watts</th>
      <th>weighted_average_watts</th>
      <th>athlete.id</th>
      <th>map.id</th>
      <th>map.polyline</th>
      <th>map.summary_polyline</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3482935194</td>
      <td>8FBE8D55-6D19-4BF3-B487-1FDCBC80C30F</td>
      <td>3719530643</td>
      <td>Afternoon Run</td>
      <td>10511.1</td>
      <td>3478</td>
      <td>3492</td>
      <td>52.3</td>
      <td>27.0</td>
      <td>2.8</td>
      <td>Run</td>
      <td>2020-05-19 23:41:31+00:00</td>
      <td>2020-05-19 16:41:31+00:00</td>
      <td>(GMT-08:00) America/Los_Angeles</td>
      <td>[37.81, -122.41]</td>
      <td>[37.81, -122.41]</td>
      <td>11</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>3.022</td>
      <td>13.3</td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>53889752</td>
      <td>a3482935194</td>
      <td>None</td>
      <td>waweF~tbjVGc@OKa@Cw@DKDIFELER@NAPGLWPIAk@Fi@r@...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3531392033</td>
      <td>C1844A33-AC45-4635-A3E4-E255C9EA3BB3</td>
      <td>3770681834</td>
      <td>Afternoon Run</td>
      <td>10371.6</td>
      <td>3303</td>
      <td>3308</td>
      <td>44.3</td>
      <td>26.4</td>
      <td>2.8</td>
      <td>Run</td>
      <td>2020-05-28 22:49:49+00:00</td>
      <td>2020-05-28 15:49:49+00:00</td>
      <td>(GMT-08:00) America/Los_Angeles</td>
      <td>[37.81, -122.41]</td>
      <td>[37.81, -122.41]</td>
      <td>14</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>3.140</td>
      <td>5.4</td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>53889752</td>
      <td>a3531392033</td>
      <td>None</td>
      <td>aaweFjvbjVEq@I]SKQ?cALUHy@[MJKPQf@?j@EP_@dAUbA...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3539038874</td>
      <td>E3A4EF8B-4F1B-4B08-A14F-2CA099AD95DB</td>
      <td>3778792319</td>
      <td>Afternoon Run</td>
      <td>10627.6</td>
      <td>3473</td>
      <td>3477</td>
      <td>44.5</td>
      <td>26.4</td>
      <td>2.8</td>
      <td>Run</td>
      <td>2020-05-30 21:32:42+00:00</td>
      <td>2020-05-30 14:32:42+00:00</td>
      <td>(GMT-08:00) America/Los_Angeles</td>
      <td>[37.81, -122.41]</td>
      <td>[37.81, -122.41]</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>3.060</td>
      <td>5.9</td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>53889752</td>
      <td>a3539038874</td>
      <td>None</td>
      <td>}aweF`sbjVQIUPg@FMDs@rAo@Lc@d@O^On@OVe@jB[rAGn...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3569837822</td>
      <td>C7E58F91-7061-4501-9156-4BED2951D572</td>
      <td>3811441999</td>
      <td>Afternoon Run</td>
      <td>21600.7</td>
      <td>7599</td>
      <td>7616</td>
      <td>172.7</td>
      <td>81.6</td>
      <td>2.4</td>
      <td>Run</td>
      <td>2020-06-05 23:03:35+00:00</td>
      <td>2020-06-05 16:03:35+00:00</td>
      <td>(GMT-08:00) America/Los_Angeles</td>
      <td>[37.81, -122.41]</td>
      <td>[37.81, -122.41]</td>
      <td>12</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>2.843</td>
      <td>14.0</td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>53889752</td>
      <td>a3569837822</td>
      <td>None</td>
      <td>gbweF~ubjVMkAmBPkAhCWX]H[n@a@`BUxAm@dGHn@Q`F]x...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3588262984</td>
      <td>72185A79-B7F0-48DB-92CC-4146885D1F50</td>
      <td>3830875861</td>
      <td>Afternoon Run</td>
      <td>5878.5</td>
      <td>1830</td>
      <td>1833</td>
      <td>32.5</td>
      <td>26.9</td>
      <td>3.3</td>
      <td>Run</td>
      <td>2020-06-09 00:25:17+00:00</td>
      <td>2020-06-08 17:25:17+00:00</td>
      <td>(GMT-08:00) America/Los_Angeles</td>
      <td>[37.81, -122.41]</td>
      <td>[37.81, -122.41]</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>3.212</td>
      <td>5.4</td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>53889752</td>
      <td>a3588262984</td>
      <td>None</td>
      <td>qaweFtubjVKi@g@WO?s@^UVi@B_@h@Uv@e@dASv@e@nA[|...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3600201601</td>
      <td>96F1DBC2-E315-41A4-997A-6E1C264F0596</td>
      <td>3843441386</td>
      <td>Evening Run</td>
      <td>4156.6</td>
      <td>1340</td>
      <td>1344</td>
      <td>44.2</td>
      <td>27.1</td>
      <td>3.6</td>
      <td>Run</td>
      <td>2020-06-11 01:48:10+00:00</td>
      <td>2020-06-10 18:48:10+00:00</td>
      <td>(GMT-08:00) America/Los_Angeles</td>
      <td>[37.81, -122.41]</td>
      <td>[37.81, -122.42]</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>0</td>
      <td>3.102</td>
      <td>5.9</td>
      <td>False</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>53889752</td>
      <td>a3600201601</td>
      <td>None</td>
      <td>{mweFnicjVJ~@CVMx@QbCI^]p@M`@DNHBRTPhALtCHb@B`...</td>
    </tr>
  </tbody>
</table>
</div>



Lets also plot a bar chart of the distance for each run. 


```python
recent_runs.set_index('id').distance.plot(kind='bar',
                                          figsize=(12,6),
                                          legend=True);
```


    
![png](/assets/img/pace_check_2/output_12_0.png)
    


Clearly the run with `id` of *3569837822* had a much larger distance than the other runs, so this must be the one we are looking for. 


```python
# mask out recent runs data frame to show only the run with the max distance
longest_run = recent_runs[recent_runs.distance == recent_runs.distance.max()].dropna(axis=1).iloc[0]
```


```python
longest_run
```




    id                                                             3569837822
    external_id                          C7E58F91-7061-4501-9156-4BED2951D572
    upload_id                                                      3811441999
    name                                                        Afternoon Run
    distance                                                          21600.7
    moving_time                                                          7599
    elapsed_time                                                         7616
    total_elevation_gain                                                172.7
    elev_high                                                            81.6
    elev_low                                                              2.4
    type                                                                  Run
    start_date                                      2020-06-05 23:03:35+00:00
    start_date_local                                2020-06-05 16:03:35+00:00
    timezone                                  (GMT-08:00) America/Los_Angeles
    start_latlng                                             [37.81, -122.41]
    end_latlng                                               [37.81, -122.41]
    achievement_count                                                      12
    kudos_count                                                             3
    comment_count                                                           0
    athlete_count                                                           1
    photo_count                                                             0
    total_photo_count                                                       0
    trainer                                                             False
    commute                                                             False
    manual                                                              False
    private                                                             False
    flagged                                                             False
    workout_type                                                            0
    average_speed                                                       2.843
    max_speed                                                              14
    has_kudoed                                                          False
    athlete.id                                                       53889752
    map.id                                                        a3569837822
    map.summary_polyline    gbweF~ubjVMkAmBPkAhCWX]H[n@a@`BUxAm@dGHn@Q`F]x...
    Name: 3, dtype: object



It seems that the API gives us a lot more fields than we had when we downloaded the data directly in [Pace Check](http://jwalk.io/projects/pace_check). The big difference is that when we downloaded data directly, it was already in GPX format and had the geospatial information built in.

The geospatial information is given to us by the API here, but it is not obvious. The [Strava developer docs](https://developers.strava.com/docs/#polylines) explain that lines are encoded using the [Google encoded polyline algorithm](https://developers.google.com/maps/documentation/utilities/polylinealgorithm). 

> "*Polyline encoding is a lossy compression algorithm that allows you to store a series of coordinates as a single string.*"

This algorithm provides an efficient way to represent a series of points by encoding the start point, and then giving the next point by the difference from the first point, and so on. We can see the encoded polyline under `map.summary_polyline`


```python
polyline_str = longest_run['map.summary_polyline']
polyline_str
```




    'gbweF~ubjVMkAmBPkAhCWX]H[n@a@`BUxAm@dGHn@Q`F]xAMv@Pp@b@rGKvDDj@h@fDT~DTlBD`B`@lBJtAd@tBDxAXz@AlERZp@vCbBlENv@EvDOTUpAs@fBGr@_Ax@uBf@QbANnAe@|AYVK`@BXPf@lA~@DrAX`@t@AZaA^B\\TfAA~Aj@p@bBAd@d@tBjCrBNd@MlAe@j@i@hCGtALrAQrAg@j@yALmCj@I`@RpEwAr@UXClAr@`KRbBr@bOVfCFTTLhBLLPpBp\\?ZKNiCp@{@zA\\zAAjAx@xJVlGHf@h@h@h@lAd@rBp@dAvAlAb@rAj@tFn@~J`@lI`@dBjArBX|AmAzWa@dDOlDUfBFl@`@pAW`BUn@yBtBq@rAs@b@WMoBBOMa@qAWABjBk@zBoBrDi@LuCxCa@xACv@P~AeA|Cc@`Eq@j@Yx@Ft@Vb@HBIq@JQJBh@hA@f@y@`A{CbAqAN_A\\u@O{BPo@MoE@eANw@p@_AR_CRuQr@{Gt@uDJW]WmEMk@OVGIq@Vw@v@{AvDGRD@uAeB{AMy@ZeAbBkAf@ZIy@RqJb@iBZmAJaTz@uD?aATgCPm@zCYJe@Y]@i@UYg@I?c@J_DrBgBNOy@Z}Bf@cAl@Yh@FZ^D`@Gx@w@dCbCmBxBeA|Cg@nKc@bPaAz@UdAOjE[tDMnA_@~AJxCUrECbDc@fJW|Hg@EETKzGYfBW\\P~JaAtMc@fC[`A_@vCuBDS_@e@OeA[BWXXx@e@sBTy@f@UZ_@BaA\\oCXaAf@q@]sAAe@tAcDxAeBnAs@nBoF]IYJiAfAcAbBoAr@aCj@c@SCs@Zo@l@cDf@eAtCwBhBu@r@i@lBgCnBwD^qAHkFF]n@s@GqAHaCCr@HNINB]g@sGGuDAcJu@}Hm@sHBo@YwDBi@NSHk@Ws@OaBL{A_AqGAiB{@oEI}CW}B{@`AZy@DYIcAf@qDTs@v@yA^]r@QRi@a@_EM}Cq@oHKkDi@_G[aHuAqRGaDN_Av@eBpCuEz@uBLaAa@cFBkAvFsArBAJY_@}Ba@kDSuC?wBSsBGqEK{AQc@SiEgD^Uk@WEiC@gAl@WWEiAb@oBJaBKyAMs@aA}B{BgCSm@ImA]eBq@}KMeGu@kDHqAcBmSOs@h@sENiCfA?r@k@~Cm@'



Encoded, this seems like complete nonsense. But we can easily decode this using the [polyline](https://pypi.org/project/polyline/) python package .


```python
import polyline

route = polyline.decode(polyline_str)
route[:10]
```




    [(37.8066, -122.40752),
     (37.80667, -122.40714),
     (37.80722, -122.40723),
     (37.8076, -122.40792),
     (37.80772, -122.40805),
     (37.80787, -122.4081),
     (37.80801, -122.40834),
     (37.80818, -122.40883),
     (37.80829, -122.40928),
     (37.80852, -122.41059)]



Success! These look like latitude-longitude pairs. Let's throw them into a geodataframe and plot it.


```python
from shapely.geometry import LineString
import geopandas as gpd

longest_run = gpd.GeoDataFrame(longest_run.to_frame().T, #make run a single record data frame again
                          geometry = [LineString([p[::-1] for p in route])], #make linestring from points, reverse order so it is long-lat, not lat-long
                          crs={'init':'epsg:4326'}) #universal lat-long coords are always in epsg:4326

longest_run.plot();
```


    
![png](/assets/img/pace_check_2/output_21_0.png)
    


Well that looks about right! Lets throw it on a folium map.


```python
import folium

m = folium.Map(location = [longest_run.centroid.y, longest_run.centroid.x],
              tiles='Carto db Positron',
              zoom_start=13)

folium.GeoJson(data=longest_run.geometry
              ).add_to(m)

m
```




<div style="width:100%;"><div style="position:relative;width:100%;height:0;padding-bottom:60%;"><iframe src="data:text/html;charset=utf-8;base64,PCFET0NUWVBFIGh0bWw+CjxoZWFkPiAgICAKICAgIDxtZXRhIGh0dHAtZXF1aXY9ImNvbnRlbnQtdHlwZSIgY29udGVudD0idGV4dC9odG1sOyBjaGFyc2V0PVVURi04IiAvPgogICAgCiAgICAgICAgPHNjcmlwdD4KICAgICAgICAgICAgTF9OT19UT1VDSCA9IGZhbHNlOwogICAgICAgICAgICBMX0RJU0FCTEVfM0QgPSBmYWxzZTsKICAgICAgICA8L3NjcmlwdD4KICAgIAogICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vbGVhZmxldEAxLjUuMS9kaXN0L2xlYWZsZXQuanMiPjwvc2NyaXB0PgogICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vY29kZS5qcXVlcnkuY29tL2pxdWVyeS0xLjEyLjQubWluLmpzIj48L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL21heGNkbi5ib290c3RyYXBjZG4uY29tL2Jvb3RzdHJhcC8zLjIuMC9qcy9ib290c3RyYXAubWluLmpzIj48L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9MZWFmbGV0LmF3ZXNvbWUtbWFya2Vycy8yLjAuMi9sZWFmbGV0LmF3ZXNvbWUtbWFya2Vycy5qcyI+PC9zY3JpcHQ+CiAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Imh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vbGVhZmxldEAxLjUuMS9kaXN0L2xlYWZsZXQuY3NzIi8+CiAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Imh0dHBzOi8vbWF4Y2RuLmJvb3RzdHJhcGNkbi5jb20vYm9vdHN0cmFwLzMuMi4wL2Nzcy9ib290c3RyYXAubWluLmNzcyIvPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL21heGNkbi5ib290c3RyYXBjZG4uY29tL2Jvb3RzdHJhcC8zLjIuMC9jc3MvYm9vdHN0cmFwLXRoZW1lLm1pbi5jc3MiLz4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9tYXhjZG4uYm9vdHN0cmFwY2RuLmNvbS9mb250LWF3ZXNvbWUvNC42LjMvY3NzL2ZvbnQtYXdlc29tZS5taW4uY3NzIi8+CiAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Imh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL0xlYWZsZXQuYXdlc29tZS1tYXJrZXJzLzIuMC4yL2xlYWZsZXQuYXdlc29tZS1tYXJrZXJzLmNzcyIvPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL3Jhd2Nkbi5naXRoYWNrLmNvbS9weXRob24tdmlzdWFsaXphdGlvbi9mb2xpdW0vbWFzdGVyL2ZvbGl1bS90ZW1wbGF0ZXMvbGVhZmxldC5hd2Vzb21lLnJvdGF0ZS5jc3MiLz4KICAgIDxzdHlsZT5odG1sLCBib2R5IHt3aWR0aDogMTAwJTtoZWlnaHQ6IDEwMCU7bWFyZ2luOiAwO3BhZGRpbmc6IDA7fTwvc3R5bGU+CiAgICA8c3R5bGU+I21hcCB7cG9zaXRpb246YWJzb2x1dGU7dG9wOjA7Ym90dG9tOjA7cmlnaHQ6MDtsZWZ0OjA7fTwvc3R5bGU+CiAgICAKICAgICAgICAgICAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwKICAgICAgICAgICAgICAgIGluaXRpYWwtc2NhbGU9MS4wLCBtYXhpbXVtLXNjYWxlPTEuMCwgdXNlci1zY2FsYWJsZT1ubyIgLz4KICAgICAgICAgICAgPHN0eWxlPgogICAgICAgICAgICAgICAgI21hcF84ZmFhYzE1ZmY0YWY0ODA2YjMwYTFiZDFmMTI4YzJhMiB7CiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgICAgICAgICAgICAgICAgIHdpZHRoOiAxMDAuMCU7CiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAxMDAuMCU7CiAgICAgICAgICAgICAgICAgICAgbGVmdDogMC4wJTsKICAgICAgICAgICAgICAgICAgICB0b3A6IDAuMCU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIDwvc3R5bGU+CiAgICAgICAgCjwvaGVhZD4KPGJvZHk+ICAgIAogICAgCiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZvbGl1bS1tYXAiIGlkPSJtYXBfOGZhYWMxNWZmNGFmNDgwNmIzMGExYmQxZjEyOGMyYTIiID48L2Rpdj4KICAgICAgICAKPC9ib2R5Pgo8c2NyaXB0PiAgICAKICAgIAogICAgICAgICAgICB2YXIgbWFwXzhmYWFjMTVmZjRhZjQ4MDZiMzBhMWJkMWYxMjhjMmEyID0gTC5tYXAoCiAgICAgICAgICAgICAgICAibWFwXzhmYWFjMTVmZjRhZjQ4MDZiMzBhMWJkMWYxMjhjMmEyIiwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBjZW50ZXI6IFszNy44MTAxNzYxNzE4NDI4NzYsIC0xMjIuNDUyNzQwOTg4ODk1MTRdLAogICAgICAgICAgICAgICAgICAgIGNyczogTC5DUlMuRVBTRzM4NTcsCiAgICAgICAgICAgICAgICAgICAgem9vbTogMTMsCiAgICAgICAgICAgICAgICAgICAgem9vbUNvbnRyb2w6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgcHJlZmVyQ2FudmFzOiBmYWxzZSwKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIAoKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgdGlsZV9sYXllcl83YjMyM2ExNjAwNGE0M2YyODc1Y2IxZjY5YWM4NDRhNCA9IEwudGlsZUxheWVyKAogICAgICAgICAgICAgICAgImh0dHBzOi8vY2FydG9kYi1iYXNlbWFwcy17c30uZ2xvYmFsLnNzbC5mYXN0bHkubmV0L2xpZ2h0X2FsbC97en0ve3h9L3t5fS5wbmciLAogICAgICAgICAgICAgICAgeyJhdHRyaWJ1dGlvbiI6ICJcdTAwMjZjb3B5OyBcdTAwM2NhIGhyZWY9XCJodHRwOi8vd3d3Lm9wZW5zdHJlZXRtYXAub3JnL2NvcHlyaWdodFwiXHUwMDNlT3BlblN0cmVldE1hcFx1MDAzYy9hXHUwMDNlIGNvbnRyaWJ1dG9ycyBcdTAwMjZjb3B5OyBcdTAwM2NhIGhyZWY9XCJodHRwOi8vY2FydG9kYi5jb20vYXR0cmlidXRpb25zXCJcdTAwM2VDYXJ0b0RCXHUwMDNjL2FcdTAwM2UsIENhcnRvREIgXHUwMDNjYSBocmVmID1cImh0dHA6Ly9jYXJ0b2RiLmNvbS9hdHRyaWJ1dGlvbnNcIlx1MDAzZWF0dHJpYnV0aW9uc1x1MDAzYy9hXHUwMDNlIiwgImRldGVjdFJldGluYSI6IGZhbHNlLCAibWF4TmF0aXZlWm9vbSI6IDE4LCAibWF4Wm9vbSI6IDE4LCAibWluWm9vbSI6IDAsICJub1dyYXAiOiBmYWxzZSwgIm9wYWNpdHkiOiAxLCAic3ViZG9tYWlucyI6ICJhYmMiLCAidG1zIjogZmFsc2V9CiAgICAgICAgICAgICkuYWRkVG8obWFwXzhmYWFjMTVmZjRhZjQ4MDZiMzBhMWJkMWYxMjhjMmEyKTsKICAgICAgICAKICAgIAogICAgICAgIGZ1bmN0aW9uIGdlb19qc29uX2NlMDJiY2E3ZmY0NDQyNjg5NzYwY2M1MjkwNzFhYTYxX29uRWFjaEZlYXR1cmUoZmVhdHVyZSwgbGF5ZXIpIHsKICAgICAgICAgICAgbGF5ZXIub24oewogICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgICAgICAgICBtYXBfOGZhYWMxNWZmNGFmNDgwNmIzMGExYmQxZjEyOGMyYTIuZml0Qm91bmRzKGUudGFyZ2V0LmdldEJvdW5kcygpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfTsKICAgICAgICB2YXIgZ2VvX2pzb25fY2UwMmJjYTdmZjQ0NDI2ODk3NjBjYzUyOTA3MWFhNjEgPSBMLmdlb0pzb24obnVsbCwgewogICAgICAgICAgICAgICAgb25FYWNoRmVhdHVyZTogZ2VvX2pzb25fY2UwMmJjYTdmZjQ0NDI2ODk3NjBjYzUyOTA3MWFhNjFfb25FYWNoRmVhdHVyZSwKICAgICAgICAgICAgCiAgICAgICAgfSkuYWRkVG8obWFwXzhmYWFjMTVmZjRhZjQ4MDZiMzBhMWJkMWYxMjhjMmEyKTsKICAgICAgICAgICAgZ2VvX2pzb25fY2UwMmJjYTdmZjQ0NDI2ODk3NjBjYzUyOTA3MWFhNjEuYWRkRGF0YSh7ImJib3giOiBbLTEyMi40ODA4NCwgMzcuODAyOTgsIC0xMjIuNDA3MTQwMDAwMDAwMDEsIDM3LjgzMzI1XSwgImZlYXR1cmVzIjogW3siYmJveCI6IFstMTIyLjQ4MDg0LCAzNy44MDI5OCwgLTEyMi40MDcxNDAwMDAwMDAwMSwgMzcuODMzMjVdLCAiZ2VvbWV0cnkiOiB7ImNvb3JkaW5hdGVzIjogW1stMTIyLjQwNzUyLCAzNy44MDY2XSwgWy0xMjIuNDA3MTQwMDAwMDAwMDEsIDM3LjgwNjY3XSwgWy0xMjIuNDA3MjMwMDAwMDAwMDEsIDM3LjgwNzIyXSwgWy0xMjIuNDA3OTIwMDAwMDAwMDIsIDM3LjgwNzZdLCBbLTEyMi40MDgwNDk5OTk5OTk5OSwgMzcuODA3NzJdLCBbLTEyMi40MDgxMDAwMDAwMDAwMiwgMzcuODA3ODddLCBbLTEyMi40MDgzNCwgMzcuODA4MDFdLCBbLTEyMi40MDg4MywgMzcuODA4MThdLCBbLTEyMi40MDkyOCwgMzcuODA4MjldLCBbLTEyMi40MTA1OTAwMDAwMDAwMSwgMzcuODA4NTJdLCBbLTEyMi40MTA4MzAwMDAwMDAwMiwgMzcuODA4NDddLCBbLTEyMi40MTE5NTk5OTk5OTk5OCwgMzcuODA4NTZdLCBbLTEyMi40MTI0MTAwMDAwMDAwMSwgMzcuODA4NzFdLCBbLTEyMi40MTI2OSwgMzcuODA4NzhdLCBbLTEyMi40MTI5NDAwMDAwMDAwMiwgMzcuODA4NjldLCBbLTEyMi40MTQzMiwgMzcuODA4NTFdLCBbLTEyMi40MTUyNCwgMzcuODA4NTddLCBbLTEyMi40MTU0NjAwMDAwMDAwMSwgMzcuODA4NTRdLCBbLTEyMi40MTYzMDAwMDAwMDAwMiwgMzcuODA4MzNdLCBbLTEyMi40MTcyNiwgMzcuODA4MjJdLCBbLTEyMi40MTc4MTAwMDAwMDAwMiwgMzcuODA4MTEwMDAwMDAwMDA2XSwgWy0xMjIuNDE4MzAwMDAwMDAwMDIsIDM3LjgwODA4XSwgWy0xMjIuNDE4ODUsIDM3LjgwNzkxXSwgWy0xMjIuNDE5MjgsIDM3LjgwNzg1XSwgWy0xMjIuNDE5ODcwMDAwMDAwMDIsIDM3LjgwNzY2XSwgWy0xMjIuNDIwMzIwMDAwMDAwMDIsIDM3LjgwNzYzXSwgWy0xMjIuNDIwNjIsIDM3LjgwNzVdLCBbLTEyMi40MjE2NSwgMzcuODA3NTFdLCBbLTEyMi40MjE3OSwgMzcuODA3NDFdLCBbLTEyMi40MjI1NSwgMzcuODA3MTZdLCBbLTEyMi40MjM1OCwgMzcuODA2NjZdLCBbLTEyMi40MjM4NjAwMDAwMDAwMiwgMzcuODA2NThdLCBbLTEyMi40MjQ3Nzk5OTk5OTk5OCwgMzcuODA2NjFdLCBbLTEyMi40MjQ4OTAwMDAwMDAwMiwgMzcuODA2NjldLCBbLTEyMi40MjUyOTk5OTk5OTk5OCwgMzcuODA2OF0sIFstMTIyLjQyNTgyLCAzNy44MDcwNl0sIFstMTIyLjQyNjA3OTk5OTk5OTk4LCAzNy44MDcxXSwgWy0xMjIuNDI2MzcwMDAwMDAwMDIsIDM3LjgwNzQyXSwgWy0xMjIuNDI2NTcsIDM3LjgwODAxXSwgWy0xMjIuNDI2OTEsIDM3LjgwODFdLCBbLTEyMi40MjczMTAwMDAwMDAwMiwgMzcuODA4MDJdLCBbLTEyMi40Mjc3OCwgMzcuODA4MjFdLCBbLTEyMi40Mjc4OTk5OTk5OTk5OCwgMzcuODA4MzRdLCBbLTEyMi40MjgwNzAwMDAwMDAwMiwgMzcuODA4NF0sIFstMTIyLjQyODIsIDM3LjgwODM4XSwgWy0xMjIuNDI4NCwgMzcuODA4MjldLCBbLTEyMi40Mjg3MiwgMzcuODA3OV0sIFstMTIyLjQyOTE0LCAzNy44MDc4N10sIFstMTIyLjQyOTMxMDAwMDAwMDAyLCAzNy44MDc3NF0sIFstMTIyLjQyOTMsIDM3LjgwNzQ3XSwgWy0xMjIuNDI4OTcwMDAwMDAwMDIsIDM3LjgwNzMzMDAwMDAwMDAxXSwgWy0xMjIuNDI4OTksIDM3LjgwNzE3XSwgWy0xMjIuNDI5MDk5OTk5OTk5OTksIDM3LjgwNzAyXSwgWy0xMjIuNDI5MDksIDM3LjgwNjY2XSwgWy0xMjIuNDI5MzEwMDAwMDAwMDIsIDM3LjgwNjE4XSwgWy0xMjIuNDI5ODEsIDM3LjgwNTkzXSwgWy0xMjIuNDMwMDAwMDAwMDAwMDIsIDM3LjgwNTk0XSwgWy0xMjIuNDMwNTkwMDAwMDAwMDEsIDM3LjgwNTc1XSwgWy0xMjIuNDMxMTcsIDM3LjgwNTA1XSwgWy0xMjIuNDMxMzYsIDM3LjgwNDk3XSwgWy0xMjIuNDMxNzUsIDM3LjgwNTA0XSwgWy0xMjIuNDMxOTcwMDAwMDAwMDIsIDM3LjgwNTIzXSwgWy0xMjIuNDMyNjYsIDM3LjgwNTQ0XSwgWy0xMjIuNDMzMDg5OTk5OTk5OTksIDM3LjgwNTQ4XSwgWy0xMjIuNDMzNTEsIDM3LjgwNTQxXSwgWy0xMjIuNDMzOTMsIDM3LjgwNTVdLCBbLTEyMi40MzQxNTAwMDAwMDAwMiwgMzcuODA1N10sIFstMTIyLjQzNDIxOTk5OTk5OTk4LCAzNy44MDYxNV0sIFstMTIyLjQzNDQ0LCAzNy44MDY4Nl0sIFstMTIyLjQzNDYxLCAzNy44MDY5MV0sIFstMTIyLjQzNTY2MDAwMDAwMDAxLCAzNy44MDY4MV0sIFstMTIyLjQzNTkyLCAzNy44MDcyNV0sIFstMTIyLjQzNjA1LCAzNy44MDczNl0sIFstMTIyLjQzNjQ0MDAwMDAwMDAyLCAzNy44MDczOF0sIFstMTIyLjQzODM3LCAzNy44MDcxMl0sIFstMTIyLjQzODg3MDAwMDAwMDAxLCAzNy44MDcwMl0sIFstMTIyLjQ0MTQ1LCAzNy44MDY3Nl0sIFstMTIyLjQ0MjEzMDAwMDAwMDAyLCAzNy44MDY2NF0sIFstMTIyLjQ0MjI0LCAzNy44MDY2XSwgWy0xMjIuNDQyMzEwMDAwMDAwMDIsIDM3LjgwNjQ5XSwgWy0xMjIuNDQyMzgwMDAwMDAwMDEsIDM3LjgwNTk2XSwgWy0xMjIuNDQyNDcwMDAwMDAwMDEsIDM3LjgwNTg5XSwgWy0xMjIuNDQ3MiwgMzcuODA1MzJdLCBbLTEyMi40NDczNDAwMDAwMDAwMSwgMzcuODA1MzJdLCBbLTEyMi40NDc0MiwgMzcuODA1MzgwMDAwMDAwMDFdLCBbLTEyMi40NDc2NzAwMDAwMDAwMiwgMzcuODA2MDddLCBbLTEyMi40NDgxMywgMzcuODA2MzddLCBbLTEyMi40NDg1ODk5OTk5OTk5OCwgMzcuODA2MjJdLCBbLTEyMi40NDg5NzAwMDAwMDAwMiwgMzcuODA2MjNdLCBbLTEyMi40NTA4NiwgMzcuODA1OTRdLCBbLTEyMi40NTIyMTAwMDAwMDAwMSwgMzcuODA1ODJdLCBbLTEyMi40NTI0MSwgMzcuODA1NzddLCBbLTEyMi40NTI2MiwgMzcuODA1NTZdLCBbLTEyMi40NTMwMSwgMzcuODA1MzVdLCBbLTEyMi40NTM1OTAwMDAwMDAwMiwgMzcuODA1MTZdLCBbLTEyMi40NTM5NCwgMzcuODA0OTFdLCBbLTEyMi40NTQzMzAwMDAwMDAwMSwgMzcuODA0NDcwMDAwMDAwMDFdLCBbLTEyMi40NTQ3NDk5OTk5OTk5OSwgMzcuODA0MjldLCBbLTEyMi40NTU5OCwgMzcuODA0MDddLCBbLTEyMi40NTc5MDAwMDAwMDAwMSwgMzcuODAzODNdLCBbLTEyMi40NTk1NywgMzcuODAzNjZdLCBbLTEyMi40NjAwOCwgMzcuODAzNDldLCBbLTEyMi40NjA2NiwgMzcuODAzMTFdLCBbLTEyMi40NjExMzAwMDAwMDAwMSwgMzcuODAyOThdLCBbLTEyMi40NjUxMSwgMzcuODAzMzddLCBbLTEyMi40NjU5NDAwMDAwMDAwMiwgMzcuODAzNTRdLCBbLTEyMi40NjY4MSwgMzcuODAzNjJdLCBbLTEyMi40NjczMzAwMDAwMDAwMiwgMzcuODAzNzNdLCBbLTEyMi40Njc1NiwgMzcuODAzNjldLCBbLTEyMi40Njc5NzAwMDAwMDAwMSwgMzcuODAzNTJdLCBbLTEyMi40Njg0NjAwMDAwMDAwMSwgMzcuODAzNjRdLCBbLTEyMi40Njg2OTk5OTk5OTk5OCwgMzcuODAzNzVdLCBbLTEyMi40NjkyOSwgMzcuODA0MzZdLCBbLTEyMi40Njk3MTAwMDAwMDAwMiwgMzcuODA0NjFdLCBbLTEyMi40Njk4OSwgMzcuODA0ODddLCBbLTEyMi40Njk4MTk5OTk5OTk5OCwgMzcuODA0OTldLCBbLTEyMi40Njk4NDAwMDAwMDAwMiwgMzcuODA1NTVdLCBbLTEyMi40Njk3NywgMzcuODA1NjNdLCBbLTEyMi40NjkzNjAwMDAwMDAwMSwgMzcuODA1OF0sIFstMTIyLjQ2OTM1MDAwMDAwMDAyLCAzNy44MDU5Ml0sIFstMTIyLjQ2OTg5LCAzNy44MDU5MDAwMDAwMDAwMV0sIFstMTIyLjQ3MDUwOTk5OTk5OTk5LCAzNy44MDYxMl0sIFstMTIyLjQ3MTQxMDAwMDAwMDAyLCAzNy44MDY2ODAwMDAwMDAwMV0sIFstMTIyLjQ3MTQ3OTk5OTk5OTk5LCAzNy44MDY4OV0sIFstMTIyLjQ3MjI1LCAzNy44MDc2NF0sIFstMTIyLjQ3MjcsIDM3LjgwNzgxXSwgWy0xMjIuNDcyOTgwMDAwMDAwMDIsIDM3LjgwNzgzXSwgWy0xMjIuNDczNDYsIDM3LjgwNzc0XSwgWy0xMjIuNDc0MjUsIDM3LjgwODA5XSwgWy0xMjIuNDc1MjIsIDM3LjgwODI3XSwgWy0xMjIuNDc1NDQsIDM3LjgwODUyXSwgWy0xMjIuNDc1NzMsIDM3LjgwODY1XSwgWy0xMjIuNDc2LCAzNy44MDg2MV0sIFstMTIyLjQ3NjE4LCAzNy44MDg0OV0sIFstMTIyLjQ3NjIsIDM3LjgwODQ0XSwgWy0xMjIuNDc1OTUwMDAwMDAwMDEsIDM3LjgwODQ5XSwgWy0xMjIuNDc1ODYwMDAwMDAwMDEsIDM3LjgwODQzXSwgWy0xMjIuNDc1ODgsIDM3LjgwODM3XSwgWy0xMjIuNDc2MjUsIDM3LjgwODE2XSwgWy0xMjIuNDc2NDUsIDM3LjgwODE1XSwgWy0xMjIuNDc2NzgsIDM3LjgwODQ0XSwgWy0xMjIuNDc3MTIsIDM3LjgwOTIyXSwgWy0xMjIuNDc3MTk5OTk5OTk5OTgsIDM3LjgwOTYzXSwgWy0xMjIuNDc3MzUsIDM3LjgwOTk1XSwgWy0xMjIuNDc3MjcsIDM3LjgxMDIyXSwgWy0xMjIuNDc3MzYsIDM3LjgxMDg0MDAwMDAwMDAwNl0sIFstMTIyLjQ3NzI4OTk5OTk5OTk4LCAzNy44MTEwOF0sIFstMTIyLjQ3NzMsIDM3LjgxMjEyXSwgWy0xMjIuNDc3MzgwMDAwMDAwMDEsIDM3LjgxMjQ3XSwgWy0xMjIuNDc3NjMsIDM3LjgxMjc1XSwgWy0xMjIuNDc3NzMsIDM3LjgxMzA3XSwgWy0xMjIuNDc3ODMwMDAwMDAwMDEsIDM3LjgxMzcxXSwgWy0xMjIuNDc4MDksIDM3LjgxNjddLCBbLTEyMi40NzgzNiwgMzcuODE4MTJdLCBbLTEyMi40Nzg0MiwgMzcuODE5MDMwMDAwMDAwMDA1XSwgWy0xMjIuNDc4MjcsIDM3LjgxOTE1XSwgWy0xMjIuNDc3MjQsIDM3LjgxOTI3XSwgWy0xMjIuNDc3MDE5OTk5OTk5OTgsIDM3LjgxOTM0XSwgWy0xMjIuNDc3MTQsIDM3LjgxOTQyXSwgWy0xMjIuNDc3MDksIDM3LjgxOTQ2XSwgWy0xMjIuNDc3MjEsIDM3LjgxOTcxXSwgWy0xMjIuNDc3NDkwMDAwMDAwMDIsIDM3LjgxOTk5XSwgWy0xMjIuNDc4NDA5OTk5OTk5OTgsIDM3LjgyMDQ1XSwgWy0xMjIuNDc4NTEsIDM3LjgyMDQ5XSwgWy0xMjIuNDc4NTIwMDAwMDAwMDIsIDM3LjgyMDQ2MDAwMDAwMDAwNF0sIFstMTIyLjQ3ODAxMDAwMDAwMDAxLCAzNy44MjA4OV0sIFstMTIyLjQ3Nzk0MDAwMDAwMDAyLCAzNy44MjEzNV0sIFstMTIyLjQ3ODA4LCAzNy44MjE2NF0sIFstMTIyLjQ3ODU4LCAzNy44MjE5OV0sIFstMTIyLjQ3ODc4LCAzNy44MjIzN10sIFstMTIyLjQ3ODczLCAzNy44MjIyM10sIFstMTIyLjQ3ODgyOTk5OTk5OTk5LCAzNy44MjI1Ml0sIFstMTIyLjQ3OTAwOTk5OTk5OTk5LCAzNy44MjQzN10sIFstMTIyLjQ3OTE1MDAwMDAwMDAyLCAzNy44MjQ5XSwgWy0xMjIuNDc5MjEsIDM3LjgyNTI5XSwgWy0xMjIuNDc5NTEsIDM3LjgyODY2XSwgWy0xMjIuNDc5NTEsIDM3LjgyOTU3XSwgWy0xMjIuNDc5NjE5OTk5OTk5OTgsIDM3LjgyOTkwMDAwMDAwMDAxXSwgWy0xMjIuNDc5NzA5OTk5OTk5OTgsIDM3LjgzMDU4XSwgWy0xMjIuNDgwNDg5OTk5OTk5OTksIDM3LjgzMDgxXSwgWy0xMjIuNDgwNTUwMDAwMDAwMDEsIDM3LjgzMDk0XSwgWy0xMjIuNDgwNDIsIDM3LjgzMTEzXSwgWy0xMjIuNDgwNDMwMDAwMDAwMDEsIDM3LjgzMTI4XSwgWy0xMjIuNDgwMzIsIDM3LjgzMTQ5XSwgWy0xMjIuNDgwMTIsIDM3LjgzMTYyXSwgWy0xMjIuNDgwMTIsIDM3LjgzMTY3XSwgWy0xMjIuNDgwMTgwMDAwMDAwMDIsIDM3LjgzMTg1MDAwMDAwMDAxXSwgWy0xMjIuNDgwNzYwMDAwMDAwMDIsIDM3LjgzMjY1XSwgWy0xMjIuNDgwODQsIDM3LjgzMzE3XSwgWy0xMjIuNDgwNTUwMDAwMDAwMDEsIDM3LjgzMzI1XSwgWy0xMjIuNDc5OTIsIDM3LjgzMzExMDAwMDAwMDAwNV0sIFstMTIyLjQ3OTU4MDAwMDAwMDAxLCAzNy44MzI5MV0sIFstMTIyLjQ3OTQ1LCAzNy44MzI2OF0sIFstMTIyLjQ3OTQ5MDAwMDAwMDAxLCAzNy44MzI0N10sIFstMTIyLjQ3OTY1LCAzNy44MzIzMzAwMDAwMDAwMDZdLCBbLTEyMi40Nzk4MjAwMDAwMDAwMiwgMzcuODMyM10sIFstMTIyLjQ4MDExLCAzNy44MzIzNF0sIFstMTIyLjQ4MDc4LCAzNy44MzI2Ml0sIFstMTIyLjQ4MDIzLCAzNy44MzE5Nl0sIFstMTIyLjQ3OTg4LCAzNy44MzEzNV0sIFstMTIyLjQ3OTY4LCAzNy44MzA1Nl0sIFstMTIyLjQ3OTUsIDM3LjgyODU2XSwgWy0xMjIuNDc5MTcsIDM3LjgyNTgyXSwgWy0xMjIuNDc5MDYwMDAwMDAwMDIsIDM3LjgyNTUyXSwgWy0xMjIuNDc4OTgsIDM3LjgyNTE3XSwgWy0xMjIuNDc4ODQsIDM3LjgyNDE1XSwgWy0xMjIuNDc4NzcwMDAwMDAwMDEsIDM3LjgyMzI0XSwgWy0xMjIuNDc4NjEwMDAwMDAwMDIsIDM3LjgyMjg0MDAwMDAwMDAxXSwgWy0xMjIuNDc4NjcsIDM3LjgyMjM2XSwgWy0xMjIuNDc4NTYsIDM3LjgyMTU5XSwgWy0xMjIuNDc4NTQsIDM3LjgyMDUzXSwgWy0xMjIuNDc4MzYsIDM3LjgxOTcxXSwgWy0xMjIuNDc4MjQsIDM3LjgxNzkxXSwgWy0xMjIuNDc4MDQwMDAwMDAwMDEsIDM3LjgxNjMyXSwgWy0xMjIuNDc4MDEwMDAwMDAwMDEsIDM3LjgxNjM1XSwgWy0xMjIuNDc3OTUsIDM3LjgxNjI0XSwgWy0xMjIuNDc3ODIsIDM3LjgxNDgyXSwgWy0xMjIuNDc3NywgMzcuODE0M10sIFstMTIyLjQ3Nzc5LCAzNy44MTQxNV0sIFstMTIyLjQ3NzQ2LCAzNy44MTIyM10sIFstMTIyLjQ3NzI4LCAzNy44MDk4OF0sIFstMTIyLjQ3NzE0LCAzNy44MDkyXSwgWy0xMjIuNDc2OTgwMDAwMDAwMDEsIDM3LjgwODg3XSwgWy0xMjIuNDc2MzksIDM3LjgwODExMDAwMDAwMDAwNl0sIFstMTIyLjQ3NjI5LCAzNy44MDgwOF0sIFstMTIyLjQ3NjEwMDAwMDAwMDAyLCAzNy44MDgyNF0sIFstMTIyLjQ3NTc1LCAzNy44MDgzMl0sIFstMTIyLjQ3NTc3MDAwMDAwMDAxLCAzNy44MDg0Nl0sIFstMTIyLjQ3NTg5OTk5OTk5OTk4LCAzNy44MDg1OF0sIFstMTIyLjQ3NjE5MDAwMDAwMDAyLCAzNy44MDg0NV0sIFstMTIyLjQ3NTYxLCAzNy44MDg2NF0sIFstMTIyLjQ3NTMyMDAwMDAwMDAxLCAzNy44MDg1M10sIFstMTIyLjQ3NTIxLCAzNy44MDgzM10sIFstMTIyLjQ3NTA1MDAwMDAwMDAxLCAzNy44MDgxOV0sIFstMTIyLjQ3NDcyLCAzNy44MDgxN10sIFstMTIyLjQ3NCwgMzcuODA4MDJdLCBbLTEyMi40NzM2NywgMzcuODA3ODldLCBbLTEyMi40NzM0MiwgMzcuODA3NjldLCBbLTEyMi40NzMsIDM3LjgwNzg0XSwgWy0xMjIuNDcyODEwMDAwMDAwMDEsIDM3LjgwNzg1XSwgWy0xMjIuNDcxOTg5OTk5OTk5OTksIDM3LjgwNzQyXSwgWy0xMjIuNDcxNDc5OTk5OTk5OTksIDM3LjgwNjk3XSwgWy0xMjIuNDcxMjIsIDM3LjgwNjU3XSwgWy0xMjIuNDcwMDIwMDAwMDAwMDIsIDM3LjgwNjAxXSwgWy0xMjIuNDY5OTcsIDM3LjgwNjE2XSwgWy0xMjIuNDcwMDMwMDAwMDAwMDEsIDM3LjgwNjI5XSwgWy0xMjIuNDcwMzkwMDAwMDAwMDEsIDM3LjgwNjY2XSwgWy0xMjIuNDcwODksIDM3LjgwN10sIFstMTIyLjQ3MTE1MDAwMDAwMDAxLCAzNy44MDc0XSwgWy0xMjIuNDcxMzcsIDM3LjgwODA1XSwgWy0xMjIuNDcxMjcsIDM3LjgwODIzXSwgWy0xMjIuNDcxMDEwMDAwMDAwMDIsIDM3LjgwODI1XSwgWy0xMjIuNDcwNzcsIDM3LjgwODExMDAwMDAwMDAwNl0sIFstMTIyLjQ2OTk1LCAzNy44MDc4OF0sIFstMTIyLjQ2OTYwMDAwMDAwMDAxLCAzNy44MDc2OF0sIFstMTIyLjQ2OTAwMDAwMDAwMDAxLCAzNy44MDY5M10sIFstMTIyLjQ2ODczMDAwMDAwMDAxLCAzNy44MDY0XSwgWy0xMjIuNDY4NTE5OTk5OTk5OTgsIDM3LjgwNjE0XSwgWy0xMjIuNDY3ODQsIDM3LjgwNTU5XSwgWy0xMjIuNDY2OTIsIDM3LjgwNTAzXSwgWy0xMjIuNDY2NTEwMDAwMDAwMDEsIDM3LjgwNDg3XSwgWy0xMjIuNDY1MzMsIDM3LjgwNDgyXSwgWy0xMjIuNDY1MTgwMDAwMDAwMDIsIDM3LjgwNDc4XSwgWy0xMjIuNDY0OTIsIDM3LjgwNDU0XSwgWy0xMjIuNDY0NTEwMDAwMDAwMDIsIDM3LjgwNDU4XSwgWy0xMjIuNDYzODU5OTk5OTk5OTgsIDM3LjgwNDUzXSwgWy0xMjIuNDY0MTIsIDM3LjgwNDU1XSwgWy0xMjIuNDY0MiwgMzcuODA0NV0sIFstMTIyLjQ2NDI3OTk5OTk5OTk5LCAzNy44MDQ1NV0sIFstMTIyLjQ2NDEzMDAwMDAwMDAxLCAzNy44MDQ1M10sIFstMTIyLjQ2Mjc1LCAzNy44MDQ3M10sIFstMTIyLjQ2MTg0LCAzNy44MDQ3N10sIFstMTIyLjQ2MDA2LCAzNy44MDQ3OF0sIFstMTIyLjQ1ODQ2OTk5OTk5OTk5LCAzNy44MDUwNV0sIFstMTIyLjQ1NjkzMDAwMDAwMDAxLCAzNy44MDUyOF0sIFstMTIyLjQ1NjY5MDAwMDAwMDAxLCAzNy44MDUyNl0sIFstMTIyLjQ1NTc3LCAzNy44MDUzOV0sIFstMTIyLjQ1NTU2MDAwMDAwMDAyLCAzNy44MDUzN10sIFstMTIyLjQ1NTQ2LCAzNy44MDUyOV0sIFstMTIyLjQ1NTI0LCAzNy44MDUyNF0sIFstMTIyLjQ1NDk4MDAwMDAwMDAyLCAzNy44MDUzNl0sIFstMTIyLjQ1NDQ5LCAzNy44MDU0NF0sIFstMTIyLjQ1NDAzLCAzNy44MDUzN10sIFstMTIyLjQ1MjY2LCAzNy44MDU2OV0sIFstMTIyLjQ1MjEzLCAzNy44MDU3XSwgWy0xMjIuNDUxMDkwMDAwMDAwMDEsIDM3LjgwNl0sIFstMTIyLjQ1MDMwMDAwMDAwMDAxLCAzNy44MDYwNV0sIFstMTIyLjQ0OTY3MDAwMDAwMDAxLCAzNy44MDYxN10sIFstMTIyLjQ1MDAwMDAwMDAwMDAyLCAzNy44MDY0N10sIFstMTIyLjQ0OTcxLCAzNy44MDYzM10sIFstMTIyLjQ0OTU4MDAwMDAwMDAxLCAzNy44MDYzXSwgWy0xMjIuNDQ5MjQwMDAwMDAwMDIsIDM3LjgwNjM1XSwgWy0xMjIuNDQ4MzUsIDM3LjgwNjE1XSwgWy0xMjIuNDQ4MDksIDM3LjgwNjA0XSwgWy0xMjIuNDQ3NjM5OTk5OTk5OTksIDM3LjgwNTc2XSwgWy0xMjIuNDQ3NDkwMDAwMDAwMDIsIDM3LjgwNTZdLCBbLTEyMi40NDc0MDAwMDAwMDAwMiwgMzcuODA1MzRdLCBbLTEyMi40NDcxOSwgMzcuODA1MjRdLCBbLTEyMi40NDYyMywgMzcuODA1NDFdLCBbLTEyMi40NDU0NCwgMzcuODA1NDhdLCBbLTEyMi40NDM5MTk5OTk5OTk5OSwgMzcuODA1NzMwMDAwMDAwMDA0XSwgWy0xMjIuNDQzMDYsIDM3LjgwNTc5XSwgWy0xMjIuNDQxNzgwMDAwMDAwMDEsIDM3LjgwNl0sIFstMTIyLjQ0MDMzLCAzNy44MDYxNF0sIFstMTIyLjQzNzIwMDAwMDAwMDAyLCAzNy44MDY1N10sIFstMTIyLjQzNjM5MDAwMDAwMDAyLCAzNy44MDY2MV0sIFstMTIyLjQzNjA3LCAzNy44MDY1M10sIFstMTIyLjQzNTU2LCAzNy44MDYyNV0sIFstMTIyLjQzNDQ5MDAwMDAwMDAxLCAzNy44MDU1Ml0sIFstMTIyLjQzMzksIDM3LjgwNTIyXSwgWy0xMjIuNDMzNTcwMDAwMDAwMDIsIDM3LjgwNTE1XSwgWy0xMjIuNDMyNDMwMDAwMDAwMDEsIDM3LjgwNTMyXSwgWy0xMjIuNDMyMDUsIDM3LjgwNTNdLCBbLTEyMi40MzE2MywgMzcuODA0MDZdLCBbLTEyMi40MzE2MTk5OTk5OTk5OCwgMzcuODAzNDhdLCBbLTEyMi40MzE0OTAwMDAwMDAwMSwgMzcuODAzNDJdLCBbLTEyMi40MzA4NjAwMDAwMDAwMSwgMzcuODAzNThdLCBbLTEyMi40MzAwMDAwMDAwMDAwMiwgMzcuODAzNzVdLCBbLTEyMi40MjkyNTAwMDAwMDAwMSwgMzcuODAzODVdLCBbLTEyMi40Mjg2NSwgMzcuODAzODVdLCBbLTEyMi40MjgwNzAwMDAwMDAwMiwgMzcuODAzOTUwMDAwMDAwMDFdLCBbLTEyMi40MjcwMTk5OTk5OTk5OCwgMzcuODAzOTldLCBbLTEyMi40MjY1NjAwMDAwMDAwMSwgMzcuODA0MDVdLCBbLTEyMi40MjYzODAwMDAwMDAwMSwgMzcuODA0MTRdLCBbLTEyMi40MjUzNywgMzcuODA0MjRdLCBbLTEyMi40MjU1MzAwMDAwMDAwMSwgMzcuODA1MDgwMDAwMDAwMDA0XSwgWy0xMjIuNDI1MzEsIDM3LjgwNTE5XSwgWy0xMjIuNDI1MjgsIDM3LjgwNTMxXSwgWy0xMjIuNDI1Mjg5OTk5OTk5OTksIDM3LjgwNl0sIFstMTIyLjQyNTUyMDAwMDAwMDAyLCAzNy44MDYzNl0sIFstMTIyLjQyNTQsIDM3LjgwNjQ4XSwgWy0xMjIuNDI1MDMsIDM3LjgwNjUxXSwgWy0xMjIuNDI0NDcwMDAwMDAwMDEsIDM3LjgwNjMzXSwgWy0xMjIuNDIzOTgsIDM3LjgwNjI3XSwgWy0xMjIuNDIzNTMwMDAwMDAwMDEsIDM3LjgwNjMzXSwgWy0xMjIuNDIzMjcsIDM3LjgwNjRdLCBbLTEyMi40MjI2NCwgMzcuODA2NzNdLCBbLTEyMi40MjE5NjAwMDAwMDAwMSwgMzcuODA3MzVdLCBbLTEyMi40MjE3Mjk5OTk5OTk5OCwgMzcuODA3NDVdLCBbLTEyMi40MjEzNCwgMzcuODA3NV0sIFstMTIyLjQyMDgzLCAzNy44MDc2NV0sIFstMTIyLjQxODc2LCAzNy44MDc5XSwgWy0xMjIuNDE3NDUwMDAwMDAwMDIsIDM3LjgwNzk3XSwgWy0xMjIuNDE2NTksIDM3LjgwODI0XSwgWy0xMjIuNDE2MTgsIDM3LjgwODE5XSwgWy0xMjIuNDEyOTEsIDM3LjgwODY5XSwgWy0xMjIuNDEyNjQ5OTk5OTk5OTksIDM3LjgwODc3XSwgWy0xMjIuNDExNTg5OTk5OTk5OTksIDM3LjgwODU2XSwgWy0xMjIuNDEwODk5OTk5OTk5OTgsIDM3LjgwODQ4XSwgWy0xMjIuNDEwODk5OTk5OTk5OTgsIDM3LjgwODEyXSwgWy0xMjIuNDEwNjgwMDAwMDAwMDEsIDM3LjgwNzg2XSwgWy0xMjIuNDEwNDUsIDM3LjgwNzA2XV0sICJ0eXBlIjogIkxpbmVTdHJpbmcifSwgImlkIjogIjMiLCAicHJvcGVydGllcyI6IHt9LCAidHlwZSI6ICJGZWF0dXJlIn1dLCAidHlwZSI6ICJGZWF0dXJlQ29sbGVjdGlvbiJ9KTsKICAgICAgICAKPC9zY3JpcHQ+" style="position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;" allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe></div></div>



Fantastic. That is definitely the route I took. You can see that I went across the bridge and back. Clearly there is some sort of measurement error as it looks like I was running over the ocean around the middle of the bridge area. 

The down side with this geospatial information is that we dont have information about each ping, like we did in the last project. I would like to know how metrics like pace and elevation varied through out the run, but `longest_run` only has information about the run as a whole. 

To get the information about each individual ping made while on my run, we have to use the [Streams](http://developers.strava.com/docs/reference/#api-Streams) endpoint of the Strava API. 


```python
run = client.get_activity_streams(id = 3569837822,
                            athlete_id = 53889752)

run = pd.DataFrame(run.to_dict())

run
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>distance</th>
      <th>altitude</th>
      <th>velocity_smooth</th>
      <th>heartrate</th>
      <th>moving</th>
      <th>grade_smooth</th>
      <th>lat</th>
      <th>lng</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0.0</td>
      <td>4.7</td>
      <td>0.0</td>
      <td>172</td>
      <td>False</td>
      <td>-1.4</td>
      <td>37.806600</td>
      <td>-122.407517</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>13.5</td>
      <td>4.4</td>
      <td>2.7</td>
      <td>172</td>
      <td>True</td>
      <td>-2.3</td>
      <td>37.806618</td>
      <td>-122.407366</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>21.4</td>
      <td>4.4</td>
      <td>2.7</td>
      <td>172</td>
      <td>True</td>
      <td>-1.8</td>
      <td>37.806646</td>
      <td>-122.407257</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10</td>
      <td>30.0</td>
      <td>4.0</td>
      <td>3.3</td>
      <td>172</td>
      <td>True</td>
      <td>-1.3</td>
      <td>37.806672</td>
      <td>-122.407184</td>
    </tr>
    <tr>
      <th>4</th>
      <td>13</td>
      <td>39.8</td>
      <td>4.0</td>
      <td>3.7</td>
      <td>172</td>
      <td>True</td>
      <td>-1.5</td>
      <td>37.806677</td>
      <td>-122.407131</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2909</th>
      <td>7604</td>
      <td>21565.7</td>
      <td>4.2</td>
      <td>3.7</td>
      <td>182</td>
      <td>True</td>
      <td>0.6</td>
      <td>37.807304</td>
      <td>-122.410505</td>
    </tr>
    <tr>
      <th>2910</th>
      <td>7607</td>
      <td>21573.1</td>
      <td>4.3</td>
      <td>3.3</td>
      <td>182</td>
      <td>True</td>
      <td>0.7</td>
      <td>37.807224</td>
      <td>-122.410500</td>
    </tr>
    <tr>
      <th>2911</th>
      <td>7609</td>
      <td>21580.1</td>
      <td>4.3</td>
      <td>2.9</td>
      <td>182</td>
      <td>True</td>
      <td>0.7</td>
      <td>37.807185</td>
      <td>-122.410498</td>
    </tr>
    <tr>
      <th>2912</th>
      <td>7612</td>
      <td>21587.2</td>
      <td>4.4</td>
      <td>2.8</td>
      <td>182</td>
      <td>True</td>
      <td>0.5</td>
      <td>37.807128</td>
      <td>-122.410467</td>
    </tr>
    <tr>
      <th>2913</th>
      <td>7614</td>
      <td>21592.9</td>
      <td>4.4</td>
      <td>2.6</td>
      <td>181</td>
      <td>True</td>
      <td>0.8</td>
      <td>37.807069</td>
      <td>-122.410445</td>
    </tr>
  </tbody>
</table>
<p>2914 rows × 9 columns</p>
</div>



That was easy! Now we already have a nice clean dataframe with speed already calculated, and latitude and longitude for each point explicitly handed to us. 


```python
run.altitude.plot();
```


    
![png](/assets/img/pace_check_2/output_29_0.png)
    


The altitude plot shows smaller spikes on the side (over fort mason and back) and the large spike in the middle (the golden gate bridge). It is pretty shocking how much the altitude changes across the bridge. 


```python
run.grade_smooth.plot();
```


    
![png](/assets/img/pace_check_2/output_31_0.png)
    


This dataframe has a few new features. One is called `grade_smooth`, which I am guessing is the [rate of change of the altitude](https://en.wikipedia.org/wiki/Grade_(slope)), an approximation of the derivative. We can approximate this calculation ourselves using the pandas methods `.diff` to take the difference between consecutive values and then `.rolling()` to group up consecutive points and aggregate (in this case I took the running average). Mathematically speaking we are calculating the numerator of the [Difference Quotient](https://en.wikipedia.org/wiki/Difference_quotient), neglecting the denominator value by assuming the difference in how far I have ran between each point is roughly the same. 


```python
run.altitude.diff(1).rolling(10).mean().plot();
```


    
![png](/assets/img/pace_check_2/output_33_0.png)
    


The two plots look nearly identitcal, so we are probably correct about what `grade_smooth` is.

Recently I saw that Strava offered an interesting metric to paying users: [Grade Adjusted Pace](https://support.strava.com/hc/en-us/articles/216917157-Strava-Training-Glossary-for-Running#gap).

> "*Grade Adjusted Pace estimates an equivalent pace when running on flat land, allowing the runner to compare hilly and flat runs more easily. Because running uphill requires extra effort, the Grade Adjusted Pace will be faster than the actual pace run. When running downhill, the Grade Adjusted Pace will be slower than the actual pace.*"

Interesting... I wonder how much the grade I am running on actually affects my pace. Let's observe the relationship between `velocity_smooth` from `grade_smooth`. 


```python
import seaborn as sns
sns.pairplot(run.loc[run.moving, ['grade_smooth', 'velocity_smooth']], height=5);
```


    
![png](/assets/img/pace_check_2/output_36_0.png)
    



```python
sns.regplot(x="grade_smooth", y="velocity_smooth", data=run[run.moving]);
```


    
![png](/assets/img/pace_check_2/output_37_0.png)
    


There doesn't seem to be a particularly strong correlation between the two features. Lets take a deeper dive into the metrics with [Statsmodels](https://www.statsmodels.org/stable/index.html)


```python
import numpy as np
import statsmodels.api as sm
import statsmodels.formula.api as smf

# Fit a simple regression model 
results = smf.ols('velocity_smooth ~ grade_smooth', data=run[run.moving]).fit()

print(results.summary())
```

                                OLS Regression Results                            
    ==============================================================================
    Dep. Variable:        velocity_smooth   R-squared:                       0.015
    Model:                            OLS   Adj. R-squared:                  0.014
    Method:                 Least Squares   F-statistic:                     42.86
    Date:                Mon, 15 Jun 2020   Prob (F-statistic):           6.92e-11
    Time:                        19:59:19   Log-Likelihood:                -3528.4
    No. Observations:                2899   AIC:                             7061.
    Df Residuals:                    2897   BIC:                             7073.
    Df Model:                           1                                         
    Covariance Type:            nonrobust                                         
    ================================================================================
                       coef    std err          t      P>|t|      [0.025      0.975]
    --------------------------------------------------------------------------------
    Intercept        2.8809      0.015    189.675      0.000       2.851       2.911
    grade_smooth    -0.0317      0.005     -6.547      0.000      -0.041      -0.022
    ==============================================================================
    Omnibus:                     2315.926   Durbin-Watson:                   0.537
    Prob(Omnibus):                  0.000   Jarque-Bera (JB):            96762.680
    Skew:                           3.453   Prob(JB):                         0.00
    Kurtosis:                      30.448   Cond. No.                         3.14
    ==============================================================================
    
    Warnings:
    [1] Standard Errors assume that the covariance matrix of the errors is correctly specified.


As one might expect, the coefficient for `grade_smooth` is negative, mean the higher the grade, the slower I usually run. However, the resulting $R^2$ is very low meaning that the grade I am running on explains very little of the variance in my pace. But, the low p-value lets us reject the null hypothesis that grade has no effect on my pace. In conclusion, the grade I am running on definitely negatively affects my pace, but not in a consistently predictable way. 

We can compute our own grade adjusted pace by compensating the real pace by how much we predict the grade to affect it.


```python
#                               grade      *    OLS ceof (-0.0317)
predicted_change_in_pace = run.grade_smooth*results.params.grade_smooth

run['grade_adjusted_pace'] = run.velocity_smooth + predicted_change_in_pace
```


```python
import matplotlib.pyplot as plt

fig, ax = plt.subplots(figsize=(15,10))

run.grade_smooth.apply(lambda x: (x-run.grade_smooth.mean()) / run.grade_smooth.var(ddof=0)
                      ).plot(ax=ax, alpha=.75, label='Grade (normalized)');

predicted_change_in_pace.plot(ax=ax, alpha=.75, label='Predicted change in pace');

ax.legend(prop={'size': 15});
```


    
![png](/assets/img/pace_check_2/output_43_0.png)
    


Although, when plotted together, there seems to be little difference between my actual pace and the grade adjusted pace.


```python
fig, ax = plt.subplots(figsize=(15,10))

run.grade_adjusted_pace.plot(ax=ax, alpha=.75);
run.velocity_smooth.plot(ax=ax, alpha=.75);

ax.legend(prop={'size': 15});
```


    
![png](/assets/img/pace_check_2/output_45_0.png)
    



```python
fig, ax = plt.subplots(figsize=(15,10))

(run.grade_adjusted_pace - run.velocity_smooth).plot(ax=ax, alpha=.75);

ax.set_title('grade_adjusted_pace - velocity_smooth');
```


    
![png](/assets/img/pace_check_2/output_46_0.png)
    


Having been the one who actually did this run, I think the strong winds affected my pace much more than the grade I was running on (I happened to run on one of the windiest I have seen). It would be interesting to compare pace with wind speed data, but I am not sure where I would be able to find it at the granularity I would require (down to the location with speed and direction). 
